<!doctype html>
<html lang="ro">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nunta Timotei 탳i Elisa</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400;1,500&family=Montserrat:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400&family=Cinzel+Decorative:wght@400;700;900&family=Great+Vibes&family=Italiana&display=swap');

    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Cormorant Garamond', serif;
      background: linear-gradient(135deg, #f5f3f0 0%, #e8e4df 100%);
      color: #4a4a4a;
      min-height: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .header {
      background: linear-gradient(135deg, #c9ada7 0%, #a8998f 100%);
      color: white;
      text-align: center;
      padding: 60px 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      position: relative;
      z-index: 1;
      overflow: hidden;
    }

    .header-flowers-left,
    .header-flowers-right {
      position: absolute;
      width: 120px;
      height: 120px;
      top: 50%;
      transform: translateY(-50%);
      opacity: 0.7;
    }

    .header-flowers-left {
      left: 5%;
    }

    .header-flowers-right {
      right: 5%;
    }

    .header h1 {
      margin: 0;
      font-size: 56px;
      font-weight: 700;
      letter-spacing: 8px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
      font-family: 'Cinzel Decorative', serif;
    }

    .header .date {
      font-size: 28px;
      margin-top: 20px;
      font-style: italic;
      opacity: 0.95;
      font-family: 'Great Vibes', cursive;
      font-weight: 400;
    }

    .header .welcome {
      font-size: 18px;
      margin-top: 20px;
      opacity: 0.9;
      font-family: 'Cormorant Garamond', serif;
      font-weight: 400;
    }

    .nav {
      background: white;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      padding: 0;
      position: relative;
    }

    .nav button {
      background: none;
      border: none;
      padding: 20px 30px;
      font-size: 16px;
      cursor: pointer;
      color: #666;
      transition: all 0.3s ease;
      font-family: 'Montserrat', sans-serif;
      font-weight: 500;
      letter-spacing: 0.5px;
      border-bottom: 3px solid transparent;
    }

    .nav button:hover {
      background: #f5f3f0;
      color: #9a8c98;
    }

    .nav button.active {
      color: #9a8c98;
      border-bottom: 3px solid #9a8c98;
      font-weight: bold;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
      position: relative;
      z-index: 1;
    }

    .section {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .section-title {
      font-size: 42px;
      color: #9a8c98;
      text-align: center;
      margin-bottom: 40px;
      font-weight: 700;
      font-family: 'Playfair Display', serif;
      letter-spacing: 3px;
      font-style: italic;
    }

    .story-content {
      background: white;
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      line-height: 1.9;
      font-size: 18px;
      font-family: 'Cormorant Garamond', serif;
      font-weight: 400;
    }

    .story-content p {
      margin-bottom: 20px;
    }

    .memory-form {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      margin-bottom: 40px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #666;
      font-size: 14px;
      font-weight: 600;
      font-family: 'Montserrat', sans-serif;
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }

    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #f0f0f0;
      border-radius: 8px;
      font-family: 'Cormorant Garamond', serif;
      font-size: 16px;
      transition: border-color 0.3s ease;
    }

    .form-group input:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #9a8c98;
    }

    .form-group textarea {
      min-height: 120px;
      resize: vertical;
    }

    .btn {
      background: #9a8c98;
      color: white;
      border: none;
      padding: 14px 32px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Montserrat', sans-serif;
      font-weight: 500;
      letter-spacing: 1px;
      text-transform: uppercase;
      box-shadow: 0 4px 12px rgba(154, 140, 152, 0.3);
    }

    .btn:hover {
      background: #7d6e7f;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(154, 140, 152, 0.4);
    }

    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .memories-list {
      display: grid;
      gap: 20px;
    }

    .memory-card {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 2px 15px rgba(0,0,0,0.06);
      border-left: 4px solid #9a8c98;
    }

    .memory-card .author {
      font-weight: 600;
      color: #9a8c98;
      margin-bottom: 10px;
      font-size: 18px;
      font-family: 'Montserrat', sans-serif;
      letter-spacing: 0.5px;
    }

    .memory-card .content {
      color: #555;
      line-height: 1.6;
      font-size: 16px;
    }

    .memory-card .date {
      color: #999;
      font-size: 12px;
      margin-top: 10px;
      font-style: italic;
    }

    .gallery-upload {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      margin-bottom: 40px;
      text-align: center;
    }

    .upload-area {
      border: 3px dashed #9a8c98;
      border-radius: 12px;
      padding: 40px;
      margin-bottom: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .upload-area:hover {
      background: #f5f3f0;
      border-color: #7d6e7f;
    }

    .upload-area input[type="file"] {
      display: none;
    }

    .upload-icon {
      font-size: 48px;
      margin-bottom: 15px;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .photo-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      transition: transform 0.3s ease;
      position: relative;
    }

    .photo-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.12);
    }

    .photo-card img {
      width: 100%;
      height: 250px;
      object-fit: cover;
    }

    .photo-card .info {
      padding: 15px;
    }

    .photo-card .uploader {
      font-size: 14px;
      color: #9a8c98;
      font-weight: 600;
      font-family: 'Montserrat', sans-serif;
    }

    .photo-card .download-btn {
      background: #a8998f;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 12px;
      cursor: pointer;
      margin-top: 10px;
      width: 100%;
      transition: background 0.3s ease;
      font-family: 'Montserrat', sans-serif;
      font-weight: 500;
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }

    .photo-card .download-btn:hover {
      background: #9a8c98;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #999;
    }

    .empty-state-icon {
      font-size: 64px;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    .loading {
      display: inline-block;
      margin-left: 10px;
    }

    .toast {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: #2c2c2c;
      color: white;
      padding: 16px 24px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      z-index: 1000;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from { transform: translateX(400px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 32px;
        letter-spacing: 3px;
      }

      .header .date {
        font-size: 20px;
      }

      .header-flowers-left,
      .header-flowers-right {
        display: none;
      }

      .nav button {
        padding: 15px 20px;
        font-size: 14px;
      }

      .section-title {
        font-size: 28px;
      }

      .story-content {
        padding: 25px;
        font-size: 16px;
      }

      .gallery-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="header">
   <svg class="header-flowers-left" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 200 200"><g transform="translate(100, 100)">
     <circle cx="0" cy="-25" r="12" fill="#9a8c98" opacity="0.8" />
     <circle cx="18" cy="-18" r="12" fill="#c9ada7" opacity="0.8" />
     <circle cx="25" cy="0" r="12" fill="#4a4a4a" opacity="0.7" />
     <circle cx="18" cy="18" r="12" fill="#9a8c98" opacity="0.8" />
     <circle cx="0" cy="25" r="12" fill="#c9ada7" opacity="0.8" />
     <circle cx="-18" cy="18" r="12" fill="#4a4a4a" opacity="0.7" />
     <circle cx="-25" cy="0" r="12" fill="#9a8c98" opacity="0.8" />
     <circle cx="-18" cy="-18" r="12" fill="#c9ada7" opacity="0.8" />
     <circle cx="0" cy="0" r="10" fill="#f5f3f0" opacity="0.9" />
     <path d="M -3,-8 L 0,-15 L 3,-8 Z" fill="#a8998f" opacity="0.6" />
     <path d="M 8,-3 L 15,0 L 8,3 Z" fill="#a8998f" opacity="0.6" />
     <path d="M 3,8 L 0,15 L -3,8 Z" fill="#a8998f" opacity="0.6" />
     <path d="M -8,3 L -15,0 L -8,-3 Z" fill="#a8998f" opacity="0.6" />
    </g>
   </svg>
   <svg class="header-flowers-right" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 200 200"><g transform="translate(100, 100)">
     <circle cx="0" cy="-25" r="12" fill="#9a8c98" opacity="0.8" />
     <circle cx="18" cy="-18" r="12" fill="#c9ada7" opacity="0.8" />
     <circle cx="25" cy="0" r="12" fill="#4a4a4a" opacity="0.7" />
     <circle cx="18" cy="18" r="12" fill="#9a8c98" opacity="0.8" />
     <circle cx="0" cy="25" r="12" fill="#c9ada7" opacity="0.8" />
     <circle cx="-18" cy="18" r="12" fill="#4a4a4a" opacity="0.7" />
     <circle cx="-25" cy="0" r="12" fill="#9a8c98" opacity="0.8" />
     <circle cx="-18" cy="-18" r="12" fill="#c9ada7" opacity="0.8" />
     <circle cx="0" cy="0" r="10" fill="#f5f3f0" opacity="0.9" />
     <path d="M -3,-8 L 0,-15 L 3,-8 Z" fill="#a8998f" opacity="0.6" />
     <path d="M 8,-3 L 15,0 L 8,3 Z" fill="#a8998f" opacity="0.6" />
     <path d="M 3,8 L 0,15 L -3,8 Z" fill="#a8998f" opacity="0.6" />
     <path d="M -8,3 L -15,0 L -8,-3 Z" fill="#a8998f" opacity="0.6" />
    </g>
   </svg>
   <h1 id="main-title">NUNTA TIMOTEI &amp; ELISA</h1>
   <div class="date" id="wedding-date">
    20 Septembrie 2027
   </div>
   <div class="welcome" id="welcome-message">
    Bine a탵i venit la celebrarea iubirii noastre!
   </div>
  </div>
  <nav class="nav"><button class="nav-btn active" data-section="story">游닀 Povestea Noastr캒</button> <button class="nav-btn" data-section="memories">游눬 Amintirile Voastre</button> <button class="nav-btn" data-section="gallery">游닝 Galeria Foto</button>
  </nav>
  <div class="container">
   <section id="story" class="section active">
    <h2 class="section-title" id="story-title">Povestea Noastr캒</h2>
    <div class="story-content">
     <p>Totul a 칥nceput 칥ntr-o zi obi탳nuit캒 de prim캒var캒, 칥n 2022, c칙nd destinul ne-a adus 칥mpreun캒 칥ntr-o cafenea mic캒 din centrul ora탳ului. Timotei comandase un cappuccino, iar Elisa tocmai terminase de citit o carte la masa de l칙ng캒 fereastr캒.</p>
     <p>O rafal캒 de v칙nt a deschis u탳a cafenelei exact c칙nd Timotei trecea pe l칙ng캒 masa Elisei, r캒sturn칙nd accidental cafeaua peste cartea ei preferat캒. 칉n loc s캒 se supere, Elisa a r칙s 탳i a spus: "Cred c캒 universul 칥ncearc캒 s캒-mi spun캒 c캒 ar trebui s캒 ies mai mult 칥n lume 칥n loc s캒 citesc despre ea."</p>
     <p>Acea zi s-a transformat 칥ntr-o plimbare de ore 칥ntregi prin parcul ora탳ului, unde am descoperit c캒 am칙ndoi iubim apusurile, muzica jazz 탳i 칥nghetata cu ciocolat캒. De atunci, fiecare zi petrecut캒 칥mpreun캒 a fost o nou캒 pagin캒 칥n povestea noastr캒 de dragoste.</p>
     <p>Dup캒 doi ani de aventuri, r칙sete 탳i sprijin reciproc, Timotei a cerut-o 칥n c캒s캒torie pe Elisa 칥n acela탳i parc unde am avut prima noastr캒 plimbare. Cu lacrimi de fericire 칥n ochi, Elisa a spus "Da" f캒r캒 ezitare.</p>
     <p>Acum, suntem gata s캒 칥ncepem cel mai frumos capitol al vie탵ii noastre 칥mpreun캒, 탳i suntem at칙t de recunosc캒tori c캒 voi, cei dragi nou캒, ve탵i fi al캒turi de noi 칥n aceast캒 zi special캒!</p>
    </div>
   </section>
   <section id="memories" class="section">
    <h2 class="section-title" id="memories-title">Amintirile Voastre</h2>
    <div class="memory-form">
     <h3 style="margin-top: 0; color: #d4a5a5;">칉mp캒rt캒탳e탳te o amintire cu noi</h3>
     <form id="memory-form">
      <div class="form-group"><label for="author-name">Numele t캒u</label> <input type="text" id="author-name" required placeholder="Introdu numele t캒u">
      </div>
      <div class="form-group"><label for="memory-content">Amintirea ta</label> <textarea id="memory-content" required placeholder="Scrie o amintire frumoas캒 cu mirii..."></textarea>
      </div><button type="submit" class="btn" id="submit-memory-btn"> Trimite Amintirea </button>
     </form>
    </div>
    <div class="memories-list" id="memories-list"></div>
   </section>
   <section id="gallery" class="section">
    <h2 class="section-title" id="gallery-title">Galeria Foto</h2>
    <div class="gallery-upload">
     <h3 style="margin-top: 0; color: #d4a5a5;">칉ncarc캒 o fotografie</h3>
     <div class="upload-area" id="upload-area">
      <div class="upload-icon">
       游닞
      </div>
      <p style="margin: 0; color: #666;">Click pentru a selecta o fotografie</p>
      <p style="margin: 10px 0 0 0; font-size: 14px; color: #999;">sau trage 탳i plaseaz캒 aici</p><input type="file" id="photo-input" accept="image/*">
     </div>
     <div class="form-group" style="text-align: left; max-width: 400px; margin: 0 auto 20px;"><label for="uploader-name">Numele t캒u</label> <input type="text" id="uploader-name" placeholder="Introdu numele t캒u">
     </div><button class="btn" id="upload-btn" disabled>칉ncarc캒 Fotografia</button>
    </div>
    <div class="gallery-grid" id="gallery-grid"></div>
   </section>
  </div>
  <script>
    const defaultConfig = {
      main_title: "NUNTA TIMOTEI & ELISA",
      wedding_date: "20 Septembrie 2027",
      welcome_message: "Bine a탵i venit la celebrarea iubirii noastre!",
      story_title: "Povestea Noastr캒",
      memories_title: "Amintirile Voastre",
      gallery_title: "Galeria Foto",
      background_color: "#f5f3f0",
      header_color: "#c9ada7",
      text_color: "#4a4a4a",
      button_color: "#9a8c98",
      accent_color: "#a8998f",
      font_family: "Cormorant Garamond",
      font_size: 16
    };

    let allData = [];
    let selectedFile = null;
    let currentSection = 'story';

    const dataHandler = {
      onDataChanged(data) {
        allData = data;
        renderMemories();
        renderGallery();
      }
    };

    async function onConfigChange(config) {
      const mainTitle = document.getElementById('main-title');
      const weddingDate = document.getElementById('wedding-date');
      const welcomeMessage = document.getElementById('welcome-message');
      const storyTitle = document.getElementById('story-title');
      const memoriesTitle = document.getElementById('memories-title');
      const galleryTitle = document.getElementById('gallery-title');

      if (mainTitle) mainTitle.textContent = config.main_title || defaultConfig.main_title;
      if (weddingDate) weddingDate.textContent = config.wedding_date || defaultConfig.wedding_date;
      if (welcomeMessage) welcomeMessage.textContent = config.welcome_message || defaultConfig.welcome_message;
      if (storyTitle) storyTitle.textContent = config.story_title || defaultConfig.story_title;
      if (memoriesTitle) memoriesTitle.textContent = config.memories_title || defaultConfig.memories_title;
      if (galleryTitle) galleryTitle.textContent = config.gallery_title || defaultConfig.gallery_title;

      const backgroundColor = config.background_color || defaultConfig.background_color;
      const headerColor = config.header_color || defaultConfig.header_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const buttonColor = config.button_color || defaultConfig.button_color;
      const accentColor = config.accent_color || defaultConfig.accent_color;

      document.body.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, #fff5f7 100%)`;
      document.body.style.color = textColor;

      const header = document.querySelector('.header');
      if (header) {
        header.style.background = `linear-gradient(135deg, ${headerColor} 0%, ${accentColor} 100%)`;
      }

      const buttons = document.querySelectorAll('.btn');
      buttons.forEach(btn => {
        btn.style.backgroundColor = buttonColor;
      });

      const sectionTitles = document.querySelectorAll('.section-title');
      sectionTitles.forEach(title => {
        title.style.color = headerColor;
      });

      const customFont = config.font_family || defaultConfig.font_family;
      const baseSize = config.font_size || defaultConfig.font_size;
      const baseFontStack = 'serif';

      document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
      
      if (mainTitle) {
        mainTitle.style.fontSize = `${baseSize * 3.5}px`;
        mainTitle.style.fontFamily = `'Cinzel Decorative', ${customFont}, ${baseFontStack}`;
      }
      if (weddingDate) {
        weddingDate.style.fontSize = `${baseSize * 1.75}px`;
        weddingDate.style.fontFamily = `'Great Vibes', cursive, ${customFont}, ${baseFontStack}`;
      }
      if (welcomeMessage) {
        welcomeMessage.style.fontSize = `${baseSize * 1.125}px`;
        welcomeMessage.style.fontFamily = `${customFont}, ${baseFontStack}`;
      }
      
      sectionTitles.forEach(title => {
        title.style.fontSize = `${baseSize * 2.625}px`;
        title.style.fontFamily = `'Playfair Display', ${customFont}, ${baseFontStack}`;
      });

      const storyContent = document.querySelector('.story-content');
      if (storyContent) {
        storyContent.style.fontSize = `${baseSize * 1.125}px`;
        storyContent.style.fontFamily = `${customFont}, ${baseFontStack}`;
      }
    }

    async function initializeApp() {
      if (window.dataSdk) {
        const initResult = await window.dataSdk.init(dataHandler);
        if (!initResult.isOk) {
          showToast('Eroare la ini탵ializarea aplica탵iei');
        }
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (value) => {
                  config.background_color = value;
                  window.elementSdk.setConfig({ background_color: value });
                }
              },
              {
                get: () => config.header_color || defaultConfig.header_color,
                set: (value) => {
                  config.header_color = value;
                  window.elementSdk.setConfig({ header_color: value });
                }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  config.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
              {
                get: () => config.button_color || defaultConfig.button_color,
                set: (value) => {
                  config.button_color = value;
                  window.elementSdk.setConfig({ button_color: value });
                }
              },
              {
                get: () => config.accent_color || defaultConfig.accent_color,
                set: (value) => {
                  config.accent_color = value;
                  window.elementSdk.setConfig({ accent_color: value });
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => config.font_family || defaultConfig.font_family,
              set: (value) => {
                config.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              }
            },
            fontSizeable: {
              get: () => config.font_size || defaultConfig.font_size,
              set: (value) => {
                config.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              }
            }
          }),
          mapToEditPanelValues: (config) => new Map([
            ["main_title", config.main_title || defaultConfig.main_title],
            ["wedding_date", config.wedding_date || defaultConfig.wedding_date],
            ["welcome_message", config.welcome_message || defaultConfig.welcome_message],
            ["story_title", config.story_title || defaultConfig.story_title],
            ["memories_title", config.memories_title || defaultConfig.memories_title],
            ["gallery_title", config.gallery_title || defaultConfig.gallery_title]
          ])
        });
      }

      setupNavigation();
      setupMemoryForm();
      setupGalleryUpload();
    }

    function setupNavigation() {
      const navButtons = document.querySelectorAll('.nav-btn');
      const sections = document.querySelectorAll('.section');

      navButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const targetSection = btn.dataset.section;
          currentSection = targetSection;

          navButtons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');

          sections.forEach(s => s.classList.remove('active'));
          document.getElementById(targetSection).classList.add('active');
        });
      });
    }

    function setupMemoryForm() {
      const form = document.getElementById('memory-form');
      const submitBtn = document.getElementById('submit-memory-btn');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const authorName = document.getElementById('author-name').value.trim();
        const content = document.getElementById('memory-content').value.trim();

        if (!authorName || !content) return;

        if (allData.length >= 999) {
          showToast('Limita maxim캒 de 999 intr캒ri a fost atins캒');
          return;
        }

        submitBtn.disabled = true;
        submitBtn.innerHTML = 'Se trimite<span class="loading">...</span>';

        const result = await window.dataSdk.create({
          type: 'memory',
          author_name: authorName,
          content: content,
          image_data: '',
          created_at: new Date().toISOString()
        });

        submitBtn.disabled = false;
        submitBtn.textContent = 'Trimite Amintirea';

        if (result.isOk) {
          form.reset();
          showToast('Amintirea a fost ad캒ugat캒 cu succes! 仇벒잺');
        } else {
          showToast('Eroare la salvarea amintiri. Te rug캒m s캒 칥ncerci din nou.');
        }
      });
    }

    function renderMemories() {
      const memoriesList = document.getElementById('memories-list');
      const memories = allData.filter(item => item.type === 'memory');

      if (memories.length === 0) {
        memoriesList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">游눬</div>
            <p>칉nc캒 nu exist캒 amintiri. Fii primul care 칥mp캒rt캒탳e탳te o amintire frumoas캒!</p>
          </div>
        `;
        return;
      }

      memoriesList.innerHTML = memories
        .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
        .map(memory => {
          const date = new Date(memory.created_at);
          const formattedDate = date.toLocaleDateString('ro-RO', {
            day: 'numeric',
            month: 'long',
            year: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
          });

          return `
            <div class="memory-card">
              <div class="author">${escapeHtml(memory.author_name)}</div>
              <div class="content">${escapeHtml(memory.content)}</div>
              <div class="date">${formattedDate}</div>
            </div>
          `;
        })
        .join('');
    }

    function setupGalleryUpload() {
      const uploadArea = document.getElementById('upload-area');
      const photoInput = document.getElementById('photo-input');
      const uploaderName = document.getElementById('uploader-name');
      const uploadBtn = document.getElementById('upload-btn');

      uploadArea.addEventListener('click', () => {
        photoInput.click();
      });

      uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.style.background = '#ffeef8';
      });

      uploadArea.addEventListener('dragleave', () => {
        uploadArea.style.background = '';
      });

      uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.style.background = '';
        
        const files = e.dataTransfer.files;
        if (files.length > 0 && files[0].type.startsWith('image/')) {
          photoInput.files = files;
          handleFileSelect(files[0]);
        }
      });

      photoInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
          handleFileSelect(e.target.files[0]);
        }
      });

      uploadBtn.addEventListener('click', async () => {
        if (!selectedFile || !uploaderName.value.trim()) {
          showToast('Te rug캒m s캒 selectezi o fotografie 탳i s캒 introduci numele t캒u');
          return;
        }

        if (allData.length >= 999) {
          showToast('Limita maxim캒 de 999 intr캒ri a fost atins캒');
          return;
        }

        uploadBtn.disabled = true;
        uploadBtn.innerHTML = 'Se 칥ncarc캒<span class="loading">...</span>';

        const reader = new FileReader();
        reader.onload = async (e) => {
          const result = await window.dataSdk.create({
            type: 'photo',
            author_name: uploaderName.value.trim(),
            content: '',
            image_data: e.target.result,
            created_at: new Date().toISOString()
          });

          uploadBtn.disabled = false;
          uploadBtn.textContent = '칉ncarc캒 Fotografia';

          if (result.isOk) {
            selectedFile = null;
            photoInput.value = '';
            uploaderName.value = '';
            uploadBtn.disabled = true;
            showToast('Fotografia a fost 칥nc캒rcat캒 cu succes! 游닞');
          } else {
            showToast('Eroare la 칥nc캒rcarea fotografiei. Te rug캒m s캒 칥ncerci din nou.');
          }
        };
        reader.readAsDataURL(selectedFile);
      });
    }

    function handleFileSelect(file) {
      if (file.size > 5 * 1024 * 1024) {
        showToast('Fotografia este prea mare. Dimensiunea maxim캒 este 5MB.');
        return;
      }

      selectedFile = file;
      document.getElementById('upload-btn').disabled = false;
      showToast(`Fotografie selectat캒: ${file.name}`);
    }

    function renderGallery() {
      const galleryGrid = document.getElementById('gallery-grid');
      const photos = allData.filter(item => item.type === 'photo');

      if (photos.length === 0) {
        galleryGrid.innerHTML = `
          <div class="empty-state" style="grid-column: 1 / -1;">
            <div class="empty-state-icon">游닝</div>
            <p>칉nc캒 nu exist캒 fotografii. 칉ncarc캒 prima fotografie de la nunt캒!</p>
          </div>
        `;
        return;
      }

      galleryGrid.innerHTML = photos
        .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
        .map(photo => `
          <div class="photo-card">
            <img src="${photo.image_data}" alt="Fotografie de la nunt캒">
            <div class="info">
              <div class="uploader">游닞 ${escapeHtml(photo.author_name)}</div>
              <button class="download-btn" onclick="downloadPhoto('${photo.__backendId}')">
                Descarc캒 Fotografia
              </button>
            </div>
          </div>
        `)
        .join('');
    }

    function downloadPhoto(backendId) {
      const photo = allData.find(item => item.__backendId === backendId);
      if (!photo) return;

      const link = document.createElement('a');
      link.href = photo.image_data;
      link.download = `nunta-timotei-elisa-${photo.author_name}-${Date.now()}.jpg`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showToast('Fotografia se descarc캒...');
    }

    function showToast(message) {
      const existingToast = document.querySelector('.toast');
      if (existingToast) {
        existingToast.remove();
      }

      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      document.body.appendChild(toast);

      setTimeout(() => {
        toast.remove();
      }, 3000);
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    initializeApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99c8b37f33ade5ae',t:'MTc2MjgxMDc1Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>